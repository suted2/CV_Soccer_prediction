# CV_Soccer_prediction
soccer_player_shootout_prediction  by classification image


## í˜ë„í‹°í‚¥ ì§ì „ ì„ ìˆ˜ì˜ ì–¼êµ´ì„ ë³´ê³  ê²°ê³¼ë¥¼ ì˜ˆìƒí•˜ê³ ì í•˜ëŠ” ëª¨ë¸ì…ë‹ˆë‹¤. 

----
ë°ì´í„°ëŠ” !gdown 1-1SS2IHJnS2b9v43mFFsyXxk4SVSwLqF ë¡œ ì‚¬ìš© ê°€ëŠ¥ 

ë°ì´í„° êµ¬ì¡°

ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡  
|ã…¡CV  
|ã…¡ã…¡Landmark  
|ã…¡ã…¡ã…¡fail  
|ã…¡ã…¡ã…¡suc  
|ã…¡ã…¡ Landmark_ch1  
|ã…¡ã…¡ã…¡grayscale96  
|ã…¡ã…¡ã…¡grayscale160  
|ã…¡ã…¡ã…¡grayscale224  
|  
|ã…¡ã…¡Landmark_image_sum  
|ã…¡ã…¡ã…¡sum2  
|ã…¡ã…¡ã…¡sum96  
|ã…¡ã…¡ã…¡sum224  
|ã…¡ã…¡ raw  
|ã…¡ã…¡ã…¡fail  
|ã…¡ã…¡ã…¡suc  
ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡ã…¡  

**ìš”ì•½**

- í•´ë‹¹ í”„ë¡œì íŠ¸ëŠ” PK ì§ì „ ì„ ìˆ˜ì˜ ì–¼êµ´ ì‚¬ì§„ì„ ë”¥ëŸ¬ë‹ì„ í†µí•´ ë¶„ì„í•˜ì—¬ ì„±ê³µë¥ ì„ ì˜ˆì¸¡í•˜ëŠ” ëª¨ë¸ì´ë‹¤.

**ì—­í• **

- ì´ 3ëª…ì˜ íŒ€ì›ê³¼ ê°™ì´ ê¸°íší•˜ê³ , ì§„í–‰í•˜ì˜€ë‹¤.
- 3ê°œì˜ ëª¨ë¸ ì¤‘ VGG, Facenet ì„ ë°”íƒ•ìœ¼ë¡œ Fine-tuning í•œ Image Classificationì„ ìœ„í•œ ëª¨ë¸ì„ êµ¬ì„±í•˜ê³  ì˜ˆì¸¡ ëª¨ë¸ì„ ì‘ì„±í•˜ì˜€ë‹¤.

**ì„±ê³¼**

- ìµœì¢… ëª¨ë¸ì„ ì•™ìƒë¸” í•˜ì—¬ ì–»ì€ ê²°ê³¼ëŠ” 63% acc , ë¥¼ ë³´ì´ê³  ìˆë‹¤.

**ì‹œê¸°**

- í”„ë¡œì íŠ¸ ì§„í–‰ ê¸°ê°„ (2023. 3. 13 ~ 2023.3.30)

**ëª©í‘œ, ëª¨ë¸ ê¸°ëŒ€ì **

- 2022 ì¹´íƒ€ë¥´ ì›”ë“œì»µì˜ ì˜¤í”„ì‚¬ì´ë“œ Detecting AIë¥¼ ë³´ê³  ìŠ¤í¬ì¸ ì™€ AIì˜ ì ‘ëª©ì´ ë§ì€ ê°€ëŠ¥ì„±ì„ ê°€ì§€ê³  ìˆë‹¤ê³  ëŠë¼ê³  ì‹œì‘í•˜ê²Œ ë˜ì—ˆë‹¤.
- ëª¨ë¸ì˜ ìµœì¢… ë°œì „ ê°€ëŠ¥ì„±ì€ ì¶•êµ¬ì— ì‹¤ì‹œê°„ ì˜ìƒì„ ë°”íƒ•ìœ¼ë¡œ í•œ ì„ ìˆ˜ì˜ ì–¼êµ´ í‘œì • ë¶„ì„ìœ¼ë¡œ PK ì„±ê³µë¥ ì„ ì˜ˆì¸¡í•˜ì—¬ ì‹œì²­ìì—ê²Œ ì¶•êµ¬ ê²½ê¸°ì— ëŒ€í•œ í¥ë¯¸ì™€ ê¸´ì¥ê°ì„ ì¶”ê°€í•œë‹¤.



# ğŸ“Detail

---

### ğŸ“” ë°ì´í„° set ë§Œë“¤ê¸°

---

- ë°ì´í„° ìˆ˜ì§‘
    
    ê¸°ì¡´ì˜ ë°ì´í„°ê°€ ì¡´ì¬í•˜ì§€ ì•Šê¸°ì— ì§ì ‘ ê²½ê¸° ì˜ìƒì—ì„œ ìº¡ì³ ë°‘ ì œì‘. 
    
    <aside>
    ğŸ’¡ ìº¡ì³ëŠ” í™”ì§ˆì´ ì´ë¯¸ì§€ ëª¨ë¸ì— ì˜í–¥ì„ ë¯¸ì¹˜ê¸°ì— 1080ì´ìƒì˜ ì˜ìƒì—ì„œ ìº¡ì³
    
    </aside>
    
     
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b060595c-97a6-47c4-9c14-82eb610ef2fb/Untitled.png)
    
    - ì´ ì–»ì€ ê²°ê³¼ ë°ì´í„°
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/267dd2bb-985f-44ca-801c-7b8506947114/Untitled.png)
    
    ë¼ë²¨ë§ì„ ë°”ë¡œ ì§ì ‘ ì§„í–‰í•˜ë©° ì‹œí–‰í•˜ì˜€ë‹¤. 
    
    label â€˜ì„±ê³µâ€™ : 910ê°œ
    
    label â€˜ì‹¤íŒ¨â€™ : 700ê°œ 
    
- ë°ì´í„° ì „ì²˜ë¦¬
    
    ê¸°ë³¸ì ìœ¼ë¡œ ì´ë¯¸ì§€ ë°ì´í„°ì— ì§„í–‰í•˜ëŠ” ì „ì²˜ë¦¬ì¸ resize, gray_scaling, augmentation, zero-centeringì„ ì§„í–‰í•˜ì˜€ë‹¤. 
    
    1ï¸âƒ£ Resize 
    
    ì‚¬ìš©í•  ëª¨ë¸ì¸ VGGëŠ” (224, 224) , Facenetì€ (160, 160) , OpenfaceëŠ” (96, 96) ìœ¼ë¡œ resizeë¥¼ 
    
    ì§„í–‰í–ˆë‹¤. 
    
    2ï¸âƒ£ Gray_scaling 
    
    ê¸°ì¡´ RGB ì‚¬ì§„ì€ (224, 224, 3) ì˜ í˜•ì‹ìœ¼ë¡œ êµ¬ì„±ë˜ì–´ R, G, B 3ì±„ë„ë¡œ ì´ë£¨ì–´ì ¸ ìˆë‹¤. 
    
    ë°ì´í„° ë³µì¡ë„ë¥¼ ë‚®ì¶˜ ë°ì´í„° ì…‹ ì—­ì‹œ ë¯¸ë¦¬ ì¤€ë¹„í•˜ì˜€ë‹¤. 
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7ddece2f-5dc7-47ee-bd31-164a5475c40f/Untitled.png)
    
    3ï¸âƒ£ Augmentation
    
    ìˆ˜ì§‘í•œ dataì˜ ì ˆëŒ€ì ì¸ ìˆ«ìê°€ ë¶€ì¡±í•˜ê¸°ì— ë³€ê²½ì„ ì§„í–‰í•˜ì˜€ë‹¤. 
    
    ì´ë•Œ ì‚¬ëŒì˜ ì–¼êµ´ì„ ê·¼ê°„ìœ¼ë¡œ ì§„í–‰í•˜ê¸°ì— horizon filpì´ ì•„ë‹Œ vertical filpìœ¼ë¡œ ì¢Œìš° ë°˜ì „ì„ ì£¼ê³  , ì‚¬ëŒì˜ ëª©ì´ ì˜í•™ìƒìœ¼ë¡œ 40ë„ ê¹Œì§€ ì›€ì§ì¼ ìˆ˜ ìˆê¸°ì—  Rotation ì—­ì‹œ -40 ~ 40 ì•ˆì—ì„œ ë³€ê²½ì‹œì¼°ë‹¤.
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/1b371a24-ff42-4ec2-a325-2ac902ef6b61/Untitled.png)
    
    4ï¸âƒ£ zero-centering 
    
    í˜„ì¬ í”½ì…€ì€ 0~ 255 ë¡œ êµ¬ì„±ë˜ì–´ìˆì–´ í•™ìŠµ ê³¼ì •ì—ì„œ ì–‘ìˆ˜ë¡œë§Œ gradientê°€ ì›€ì§ì¸ë‹¤. 
    
    ì´ë¥¼ ë°©ì§€í•˜ê³ ì train_datasetì˜ í‰ê· ìœ¼ë¡œ ì „ì²´ dataì˜ í‰ê· í”½ì…€ì„ 0ìœ¼ë¡œ ì´ë™ì‹œì¼œì£¼ëŠ” ë°ì´í„°ë¥¼ ë§Œë“ ë‹¤.
    
    
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/12d454e5-e9e0-4b01-a3c9-377b74712a0f/Untitled.png)
    
    
## ğŸ” Modeling I

---

- ëª¨ë¸ ì„ ì •
    - VGG Face ( VGG-16)
        - ê¸°ì¡´ VGG ëª¨ë¸ê³¼ ë§ˆì°¬ê°€ì§€ë¡œ 3 x 3 ì˜ í•„í„°ë¥¼ ì‚¬ìš©í•˜ëŠ” íŠ¹ì§•ì„ ê°€ì§
        - Face dataì— ë§ì¶° í•™ìŠµì„ ì‹œì¼œë‘” model
        
        [Visual Geometry Group - University of Oxford](https://www.robots.ox.ac.uk/~vgg/data/vgg_face/)
        
    - Facenet
        - ê¸°ì¡´ ì´ë¯¸ì§€ ë¶„ë¥˜ì™€ ë‹¤ë¥´ê²Œ face embeddingì„ 128ì°¨ì›ì˜ ë²¡í„°ë¡œ ë‚˜ì˜¨ë‹¤.
        - triplet loss ( ê¸°ì¤€ ì´ë¯¸ì§€ì™€ ê°™ì€ ì´ë¯¸ì§€ëŠ” ê°™ê²Œ, ë‹¤ë¥¸ ì´ë¯¸ì§€ëŠ” ë©€ê²Œ )  by ìœ í´ë¦¬ë“œ ê±°ë¦¬
        
        [Papers with Code - FaceNet: A Unified Embedding for Face Recognition and Clustering](https://paperswithcode.com/paper/facenet-a-unified-embedding-for-face)
        
    - Openface
        - ê¸°ì¡´ facenetì—ì„œ small dataset( 224 â†’ 96 ) ìœ¼ë¡œ ì§„í–‰í•œ ë°ì´í„°.
        
        [OpenFace](https://cmusatyalab.github.io/openface/)
        
- ëª¨ë¸ ë¹Œë“œ
    
    https://github.com/serengil/deepface_models í•´ë‹¹ ê¹ƒí—ˆë¸Œì—ì„œ pre-train modelì„ loadí•˜ì˜€ë‹¤. 
    
    1ï¸âƒ£ VGG model 
    
    ```python
    ##VGG 7ê°œ í•˜ìœ„ì¸µ
    
    model.add(ZeroPadding2D((1,1)))
    model.add(Convolution2D(512, (3, 3), activation='relu'))
    model.add(ZeroPadding2D((1,1)))
    model.add(Convolution2D(512, (3, 3), activation='relu'))
    model.add(ZeroPadding2D((1,1)))
    model.add(Convolution2D(512, (3, 3), activation='relu'))
    model.add(MaxPooling2D((2,2), strides=(2,2)))
     
    model.add(Convolution2D(4096, (7, 7), activation='relu'))
    model.add(Dropout(0.5))
    model.add(Convolution2D(4096, (1, 1), activation='relu'))
    model.add(Dropout(0.5))
    model.add(Convolution2D(2622, (1, 1)))
    model.add(Flatten())
    model.add(Activation('softmax'))
    
    Convolution2D(2, (1, 1), name='predictions')(model.layers[-4].output)
    base_model_output = Flatten()(base_model_output)
    base_model_output = Activation('softmax')(base_model_output)
    ```
    
    ìœ„ì— ì•„ë˜ conv layerê°€ 2622ì˜ faceë¥¼ ë¶„ë¥˜í•˜ëŠ” ëª¨ë¸ì´ê¸°ì— ìš°ë¦¬ì˜ ëª¨ë¸ì˜ ëª©í‘œëŠ” 
    
    ì„±ê³µ/ ì‹¤íŒ¨ì˜ ë‘ê°€ì§€ ê²½ìš°ì´ê¸°ì— ì•„ë˜ì— í•´ë‹¹í•˜ëŠ” ëª¨ë¸ë¡œ ë¹Œë“œí•´ì£¼ì—ˆë‹¤. 
    
    ê¸°ì¡´ì˜ ì–¼êµ´ ì‚¬ì§„ì´ë¼ëŠ” ìœ ì‚¬ë„ë¥¼ ê°€ì§€ê³  ìˆì–´ì„œ fine-tuneì„ ë¶„ë¥˜ê¸° ë¿ ì•„ë‹ˆë¼ ì¼ë¶€ë¥¼ 
    
    ì¬í•™ìŠµ í•˜ëŠ” ë°©ì‹ì„ ì‚¬ìš©í–ˆë‹¤. 
    
    2ï¸âƒ£ Facenet 
    
    ```python
    up = Lambda(scaling, output_shape=K.int_shape(up)[1:], arguments={"scale": 1})(up)
        x = add([x, up])
    
    # Classification block
    x = GlobalAveragePooling2D(name="AvgPool")(x)
    x = Dropout(1.0 - 0.8, name="Dropout")(x)
    # Bottleneck
    x = Dense(dimension, use_bias=False, name="Bottleneck")(x)
    x = BatchNormalization(momentum=0.995, epsilon=0.001, scale=False, name="Bottleneck_BatchNorm")(
        x
    
    base_model_output = Sequential()
    base_model_output = Convolution2D(2, (2, 2), name='predictions')(model.layers[-5].output)
    base_model_output = Convolution2D(2, (2, 2), name='predictions1')(base_model_output)
    
    base_model_output = Flatten()(base_model_output)
    base_model_output = Activation('softmax')(base_model_output)
    ```
    
    Facenet ì—­ì‹œ ë§ˆì°¬ê°€ì§€ë¡œ ë¶„ë¥˜ê¸° + ConV ì¼ë¶€ë¶„ì„ fine_tuningì„ ì§„í–‰í•˜ì˜€ê³  ë¶„ë¥˜ê¸°ë¥¼ ìˆ˜ì •ëœ ì½”ë“œ ì²˜ëŸ¼ ì´ì§„ë¶„ë¥˜ì˜ ì½”ë“œë¡œ ìˆ˜ì •ì„ í•˜ì˜€ë‹¤. 
    
    3ï¸âƒ£ Openface 
    
    Facenetì´ë‘ image_size ì˜ ì°¨ì´ë¥¼ ì œì™¸í•˜ê³ ëŠ” ì¡´ì¬í•˜ì§€ ì•Šê¸°ì— ìœ„ì™€ ê°™ì€ êµ¬ì¡°ë¡œ ì§„í–‰ë˜ì—ˆë‹¤.
    
    
    
    
    - ëª¨ë¸ ê²°ê³¼ í™•ì¸
    
    1ï¸âƒ£ Inception Resnet ( = Facenet) 
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/69020bbf-2945-4fd2-825d-a19fe713a433/Untitled.png)
    
    ë‹¤ìŒê³¼ ê°™ì€ ê²°ê³¼ê°€ ë‚˜ì˜¨ë‹¤. íŠ¹ì • ì‹œì ì—ì„œ ê³¼ì í•©ì´ ì§„í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤. í˜„ì¬ ëª¨ë¸ì€ loadí•´ì„œ ì‚¬ìš©í•˜ê³  ìˆê¸°ì— ì´ë¥¼ í•´ì†Œí•˜ê¸° ìœ„í•´ì„œ ë°ì´í„°ì˜ ë³µì¡ë„ë¥¼ ì¦ê°€ì‹œì¼œì•¼ í•œë‹¤ê³  íŒë‹¨í•˜ì—¬ ì¶”ê°€ì ì¸ ì ˆì°¨ê°€ í•„ìš”í•˜ë‹¤ê³  ìƒê°í–ˆë‹¤. 
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/66d52956-56b6-4e8e-9f0f-1c1c7c5463b3/Untitled.png)
    
    accuarcy ëŠ” 73% ë¥¼ ê¸°ë¡í–ˆê³  ì¢€ ë” ìì„¸í•œ ìˆ˜ì¹˜ íŒŒì•…ì„ ìœ„í•´ 
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b3b038a8-3a3e-4ea9-92b7-8906c64873e8/Untitled.png)
    
    metricsë¥¼ í†µí•´ ì§„í–‰ì„ í–ˆë‹¤.  ë¼ë²¨ 0 â€˜ì‹¤íŒ¨â€™ ì˜ recall ê°’ì´ ìœ ë… ë‚®ì€ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆì—ˆë‹¤. 
    
- ì¶”ê°€ ì „ì²˜ë¦¬ ëœ ë°ì´í„° ì ìš©
    
    1ï¸âƒ£ Facenet _ variation 
    
    1. augmentation : ë¯¸ì„¸í•œ ìƒìŠ¹ì´ ì¡´ì¬í•˜ì§€ë§Œ ëˆˆì— ë„ëŠ” ìƒìŠ¹ì€ X 
    2. gray_scale : ê¸°ì¡´ì— ê³¼ì í•©ì´ë¼ê³  ìƒê°í–ˆë˜ ê²ƒì²˜ëŸ¼. ë°ì´í„°ì˜ ë³µì¡ë„ë¥¼ ë‚®ì¶”ëŠ” ê±´ 
        
        ìƒê°ëŒ€ë¡œ ë” ë‚®ì€ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤. 
        
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7409defa-f039-4317-bf49-04bad8971a3e/Untitled.png)
    
    ![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/63719cf3-b630-46d9-94e0-1cf1e772860d/Untitled.png)
    
    ìˆ˜ì¹˜ê°€ recallì—ì„œëŠ” ì¹˜ì¤‘ë˜ì–´ìˆë‹¤.  recallì—ì„œì˜ ìˆ˜ì¹˜.
    
    ğŸŒ» ê²° ë¡  
    
    ê¸°ì¡´ì˜ ì´ë¯¸ì§€ ì •í™•ë„ë‚˜ F1 ìŠ¤ì½”ì–´ì—ì„œ ì¢€ ë” í–¥ìƒëœ ë°©ë²•ë¡ ì„ ì–»ê¸° ìœ„í•œ ë°©ë²•ì´ ë­ê°€ ìˆì„ê¹Œ.? 
    
    <aside>
    ğŸ’¡ discussion : ê¸°ì¡´ì˜ ì–¼êµ´ ì¸ì‹ ì•Œê³ ë¦¬ì¦˜ì´ ì–¼êµ´ detecting â†’ feature extraction â†’ classification ì´ë‹¤. ì—¬ê¸°ì„œ ê¸°ì¡´ì˜ 68landmark ëŒ€ì‹  3D mash feature ë¥¼ ë”í•´ì¤˜ì„œ ëˆˆ ì½”ì…, ì–¼êµ´ í˜•ì˜ íŠ¹ì§•ì„ ê°€ë¥´ì³ì¤€ë‹¤ë©´ ì¢€ ë” ì¢‹ì€ ê²°ê³¼ê°€ ë‚˜ì˜¤ì§€ ì•Šì„ê¹Œ.
    
    </aside>
    
    
    
    






